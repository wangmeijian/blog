# React中共享组件之间状态逻辑的三种方式

废话少说，这三种方式分别是：render props、高阶组件和自定义Hook。下面依次演示

假设有一个```TimeOnPage```组件专门用来记录用户在当前页面停留时间，像这样：

```js
const TimeOnPage = () => {
  const [second, setSecond] = useState(0);

  useEffect(() => {
    setTimeout(() => {
      setSecond(second + 1);
    }, 1000);
  }, [second]);
  return (
    <div>停留时间：{second}秒</div>
  );
}
```
如果另一个组件需要用到这个停留时间，如何共享过去？我们能否封装一下，以便轻松地与其它组件共享它？

很自然地想到子组件嵌套的方式，利用props传参

```js
const Child = (props) => {
  return <div>stayTime: {props.stayTime}s</div>;
};

const TimeOnPage = () => {
  const [second, setSecond] = useState(0);

  useEffect(() => {
    setTimeout(() => {
      setSecond(second + 1);
    }, 1000);
  }, [second]);
  return (
    <div>
      <Child stayTime={second} />
    </div>
  );
}
```

这属于在 ```TimeOnPage```组件内部硬编码，还没有达到封装复用的目标。看看render props怎么做？

## render props

 官网解释：

 > “render prop” 是指一种在 React 组件之间使用一个值为函数的 prop 共享代码的简单技术

接上文，在TimeOnPage里定义一个值为函数的prop，想渲染什么组件，在函数里返回即可。

```js
const Child = (props) => {
  return <div>stayTime: {props.stayTime}s</div>;
};

const TimeOnPage = (props) => {
  const [second, setSecond] = useState(0);

  useEffect(() => {
    setTimeout(() => {
      setSecond(second + 1);
    }, 1000);
  }, [second]);
  return <div>{props.render(second)}</div>;
};

<TimeOnPage render={(stayTime) => <Child stayTime={stayTime} />
```
其实，render prop 就是一个用于告知组件需要渲染什么内容的函数prop。
