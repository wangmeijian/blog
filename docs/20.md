# 用docker搭建前端环境

开发环境的搭建，是新人入职后的第一道槛，有时一个小小的问题就能阻塞半天。如果能在短时间内搞定开发环境，势必提高新人对团队的印象分！将环境搭在docker里，是个不错的选择。

## 镜像&容器
docker有个概念叫镜像，官方概念比较拗口，这么解释比较容易理解：docker仓库有很多镜像，包括node、nginx、redis等等，一个镜像一般解决一个问题，镜像没有状态，而且永远不会改变。容器，是镜像执行的地方。

## Dockerfile
第一步，**[安装docker](https://docs.docker.com/get-docker/)**，然后在前端项目根目录，**新建.Dockerfile配置文件**
```js
 FROM node:10.13.0
 WORKDIR /app
 COPY . .
 RUN npm install
 CMD ["npm", "run", "dev"]
```
FROM：指定当前镜像依赖的镜像  
WORKDIR：指定工作目录
COPY：拷贝文件  
RUN：在项目打包为镜像时执行指定命令  
CMD：镜像在容器中启动时执行的命令 

以上配置的意思是，安装nodejs 10.13.0，拷贝当前项目所有文件到镜像的根目录下的/app文件夹，然后执行npm install安装前端依赖包。

## 创建镜像
**把项目打包为镜像**，注意最后有个点，意思是当前文件夹
```js
docker build -t my-app .
```

## 创建容器
**创建容器**，注意，前端项目一般会开启DevServer，host必须配置为0.0.0.0，否则在宿主机上无法访问docker容器内部的开发环境。

创建名字为my-app-container的容器，执行的镜像是my-app，假设DevServer配置的端口为8080，将容器内的8080映射到宿主机的8080端口，冒号前面的是宿主机端口，后面的是docker容器的端口。
```js
docker run -dp 8080:8080 --name my-app-container my-app
```
容器会自动执行Dockerfile指定的CMD命令，稍后就可以在浏览器输入http://localhost:8080 访问容器内的开发环境了。

